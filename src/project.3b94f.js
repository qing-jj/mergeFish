window.__require=function e(t,n,i){function c(s,a){if(!n[s]){if(!t[s]){var l=s.split("/");if(l=l[l.length-1],!t[l]){var r="function"==typeof __require&&__require;if(!a&&r)return r(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+s+"'")}}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){return c(t[s][1][e]||e)},h,h.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<i.length;s++)c(i[s]);return c}({BaseView:[function(e,t,n){"use strict";cc._RF.push(t,"69415br/ZlJtYaBixm1aQFv","BaseView"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.log(this.node.name)},start:function(){cc.log("init a baseview")},closeView:function(){cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(Global.mainscene.addFishBtnound,!1,1),this.node.active=!1,Global.mainscene.maskBg.node.active=!1}}),cc._RF.pop()},{}],FishCalc:[function(e,t,n){"use strict";cc._RF.push(t,"d3537tfAQdCmrByf+ZxgpvO","FishCalc"),cc.Class({properties:{trackcount:2,currentdiamonds:0,currentexp:0,currentlevel:1,doublespeedtime:0,fishtoplevel:{get:function(){return this._fishtoplevel||(this._fishtoplevel=1),this._fishtoplevel},set:function(e){this._fishtoplevel=e}},currentcoins:{get:function(){return this._currentcoins||(this._currentcoins=1e5),this._currentcoins},set:function(e){this._currentcoins=parseInt(e),cc.mf.mainscene.node&&cc.mf.mainscene.node.emit("NOTI_COINCHANGE",e)}},boughtfishes:null,currenttopexp:{get:function(){return this.levelexp(this.currentlevel)}},audio_flag:!0},ctor:function(){cc.log("ctor fishcalc"),this.boughtfishes={}},statics:{},onLoad:function(){cc.log("onload: "+this.__classname__)},start:function(){cc.log("start fishcalc")},computeNumber:function(e){return e>=0&&e<1e3?e:e>=1e3&&e<1e4?(e/1e3).toFixed(2)+"K":e>=1e4&&e<1e5?(e/1e3).toFixed(1)+"K":e>=1e5&&e<1e6?(e/1e6).toFixed(2)+"M":e>=1e6&&e<1e7?(e/1e6).toFixed(2)+"M":e>=1e7&&e<1e8?(e/1e6).toFixed(1)+"M":e>=1e8&&e<1e9?(e/1e9).toFixed(2)+"G":e>=1e9&&e<1e10?(e/1e9).toFixed(2)+"G":e>=1e10&&e<1e11?(e/1e9).toFixed(1)+"G":e>=1e11&&e<1e12?(e/1e12).toFixed(2)+"T":e>=1e12&&e<1e13?(e/1e12).toFixed(2)+"T":e>=1e13&&e<1e14?(e/1e12).toFixed(1)+"T":e>=1e14&&e<1e15?(e/1e15).toFixed(2)+"P":e>=1e15&&e<1e16?(e/1e15).toFixed(2)+"P":void 0},defaultfishlevel:function(){return Math.max(this.fishtoplevel-4,1)},defaultfishcost:function(){return this.fishcost(this.defaultfishlevel())},fishcount:function(e){return null==this.boughtfishes[e]?(this.boughtfishes[e]=0,0):this.boughtfishes[e]},fishcost:function(e){return 1==e?parseInt((100*Math.exp(.0679*this.fishcount(e))).toFixed(0)):parseInt((500*Math.pow(3,e-2)*Math.exp(.161*this.fishcount(e))).toFixed(0))},levelexp:function(e){return 5*Math.pow(2,e-1)},buyfish:function(e){this.currentcoins>this.fishcost(e)?(this.currentcoins-=this.fishcost(e),this.currentexp+=e,this.currentexp>=this.currenttopexp&&(this.currentexp-=this.currenttopexp,this.currentlevel+=1,cc.mf.mainscene.node.emit("NOTI_LEVELCHANGE",this.currentlevel)),cc.mf.mainscene.node.emit("NOTI_EXPCHANGE",this.currentexp),null==this.boughtfishes[e]&&(this.boughtfishes[e]=0),this.boughtfishes[e]=this.boughtfishes[e]+1,cc.mf.mainscene.node&&cc.mf.mainscene.node.emit("NOTI_FISHCHANGE",e)):(cc.mf.warnText="No enough money",cc.mf.mainscene.this.showView(event,"warnView","Not enough money"))},fishearn:function(e){return parseInt((5*Math.pow(2,e-1)).toFixed(0))},fishsellcost:function(e){return parseInt((100*Math.pow(2,e-1)).toFixed(0))}}),cc._RF.pop()},{}],drawtest:[function(e,t,n){"use strict";cc._RF.push(t,"80ce7C480lFgZlrdkX5y72T","drawtest"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],endpoint:[function(e,t,n){"use strict";cc._RF.push(t,"82ed0KVCc9FSYG4yYLWuzGi","endpoint"),cc.Class({extends:cc.Component,properties:{numberlabel:cc.Label,coins:{get:function(){return this._coins||(this._coins=0),this._coins},set:function(e){this.numberlabel.string=e,this._coins=e}}},start:function(){},onCollisionEnter:function(e,t){if("fish"==e.node.name){cc.mf.FishCalc.currentcoins+=cc.mf.FishCalc.fishearn(e.node.getComponent("fish").level),this.earnCoinsAction(cc.mf.FishCalc.computeNumber(cc.mf.FishCalc.fishearn(e.node.getComponent("fish").level)));var n=Global.mainscene.coinlabel.node;cc.tween(this.node).to(.2,{scale:1.2}).to(.2,{scale:1}).start(),cc.tween(n).to(.2,{scale:1.2}).to(.2,{scale:1}).start();var i=cc.find("Canvas/endpoint/endpointcoin");i&&i.getComponent("cc.ParticleSystem").resetSystem(),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(Global.mainscene.coinsound,!1,1)}},earnCoinsAction:function(e){var t=new cc.Node;t.addComponent(cc.Sprite),t.getComponent("cc.Sprite").sizeMode=cc.Sprite.SizeMode.CUSTOM,t.width=24,t.height=24,cc.loader.loadRes("ui/btn_coins",cc.SpriteFrame,function(e,n){e?cc.log(e):t.getComponent("cc.Sprite").spriteFrame=n});var n=new cc.Node;n.addComponent(cc.Label),n.getComponent("cc.Label").string="+"+e,n.getComponent("cc.Label").fontSize=16,n.getComponent("cc.Label").lineHeight=16,n.getComponent("cc.Label").horizontalAlign=-1,n.getComponent("cc.Label").overflow=1,n.width=80,n.height=16,t.addChild(n),this.node.addChild(t),n.setPosition(t.getPosition().add(cc.v2(54,4))),cc.tween(t).to(.4,{position:cc.v2(0,0),opacity:255}).to(.4,{position:cc.v2(0,60),opacity:0}).call(function(){t.destroy()}).start()}}),cc._RF.pop()},{}],fish:[function(e,t,n){"use strict";cc._RF.push(t,"7707fHMJHFH2qQnlgEpmLKY","fish"),cc.Class({extends:cc.Component,properties:{beingDragged:!1,bigScale:1.5,normalScale:1,running:!1,defaultSpeed:1,level:{type:cc.Integer,set:function(e){this._level=e;var t=this;cc.loader.loadRes("fish/fish"+e,cc.SpriteFrame,function(e,n){e?cc.log(e):t.getComponent("cc.Sprite").spriteFrame=n})},get:function(){return null==this._level&&(this._level=1),this._level}},landid:{type:cc.Integer,set:function(e){this._landid=e,this.landidlabel.string=e},get:function(){return null===this._landid&&(this._landid=-1),this._landid}},landidlabel:cc.Label,isclone:!1,cloneowner:cc.Node,runaction:cc.Action},ctor:function(){},start:function(){},onLoad:function(){this.node.getComponent("cc.CircleCollider").enabled=!1,this.receivetouch(!0)},receivetouch:function(e){e?(this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)):(this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this))},onTouchStart:function(e){this.node.zIndex=cc.macro.MAX_ZINDEX,this.node.scale=this.bigScale,this.beingDragged=!0,this.node.getComponent("cc.CircleCollider").enabled=!0,Global.mainscene.highlightfishlevel(this.level)},onTouchMove:function(e){this.node.x+=e.getDelta().x,this.node.y+=e.getDelta().y},onTouchEnd:function(e){this.node.zIndex=0,Global.mainscene.highlightfishlevel(this.level,!1),this.beingDragged=!1,this.node.scale=this.normalScale,this.node.getComponent("cc.CircleCollider").enabled=!1,Global.mainscene.releasefish(this)},scalebig:function(){this.node.scale=this.bigScale},scalenormal:function(){this.node.scale=this.normalScale},onCollisionEnter:function(e,t){this.beingDragged&&"fish"==e.node.name&&t.node.getComponent("fish").level==e.node.getComponent("fish").level&&(this.scalebig(),this.beingDragged)},onCollisionStay:function(e,t){},onCollisionExit:function(e,t){this.beingDragged?this.node.scale=this.bigScale:this.scalenormal()},onDestroy:function(){},returnback:function(){Global.mainscene.lands[0].getComponent("land").findland(this.landid).attachFishNode(this.node)},runcircle:function(){var e=this;this.running=!0,Global.mainscene.lands[0].getComponent("land").findland(this.landid).fishup(),this.node.getComponent("cc.CircleCollider").enabled=!0,cc.loader.loadRes("fish/fish"+this.level+"s",cc.SpriteFrame,function(t,n){e.node.getComponent("cc.Sprite").spriteFrame=n});var t=Math.pow(this.level,.8)*this.defaultSpeed/this.level;this.node.setPosition(165,this.node.getPosition().y),this.node.angle=90;var n=1*t,i=.55*t,c=cc.tween().to(n,{position:cc.v2(165,-190)}),o=cc.spawn(cc.bezierBy(i,[cc.v2(0,0),cc.v2(0,-60),cc.v2(-60,-60)]),cc.rotateBy(i,-90)).easing(cc.easeOut(2)),s=cc.tween().by(n,{position:cc.v2(-210,0)}),a=cc.spawn(cc.bezierBy(i,[cc.v2(0,0),cc.v2(-60,0),cc.v2(-60,60)]),cc.rotateBy(i,-90)).easing(cc.easeOut(2)),l=cc.tween().by(2*n,{position:cc.v2(0,385)}),r=cc.spawn(cc.bezierBy(i,[cc.v2(0,0),cc.v2(0,60),cc.v2(60,60)]),cc.rotateBy(i,-90)).easing(cc.easeOut(2)),h=cc.tween().by(n,{position:cc.v2(210,0)}),d=cc.spawn(cc.bezierBy(i,[cc.v2(0,0),cc.v2(60,0),cc.v2(60,-60)]),cc.rotateBy(i,-90)).easing(cc.easeOut(2)),u=cc.tween().to(n,{position:cc.v2(165,13)}),f=c.then(o).then(s).then(a).then(l).then(r).then(h).then(d).then(u);this.runaction=cc.tween(this.node).repeatForever(f)._union(),cc.mf.fishActionManager.addAction(this.runaction,this.node,!1)}}),cc._RF.pop()},{}],global:[function(e,t,n){"use strict";cc._RF.push(t,"8f890gVEXlEGJ6NTzVLRYqv","global"),window.Global={mainscene:null},cc._RF.pop()},{}],land:[function(e,t,n){"use strict";cc._RF.push(t,"6e31er9VjFCnYSvoWhnfQNv","land"),cc.Class({extends:cc.Component,properties:{fishPrefab:cc.Prefab,landid:0,fishshadownode:cc.Node,fishnode:{type:cc.Node,set:function(e){this._fishnode=e},get:function(){return this._fishnode}},fish:{get:function(){return this.fishnode?this.fishnode.getComponent("fish"):null}},levellabel:cc.Label,levelbg:cc.Sprite},onLoad:function(){cc.log("onload: "+this.__classname__)},start:function(){},dropFish:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=cc.instantiate(this.fishPrefab);return Global.mainscene.node.addChild(t),this.attachFishNode(t),t.getComponent("fish").level=e,this.levellabel.string=e,t},attachFishNode:function(e){e.setPosition(this.node.getPosition().add(cc.v2(0,20))),this.fishnode=e,e.getComponent("fish").landid=this.landid,Global.mainscene.refreshLandLevelLabel(),this.levellabel.string=e.getComponent("fish").level},onCollisionEnter:function(e,t){if("fish"==e.node.name&&this.fishnode){if(this.fishnode.getComponent("fish").level!=e.node.getComponent("fish").level)return;this.fishnode.getComponent("fish").scalebig()}},onCollisionStay:function(e,t){},onCollisionExit:function(e,t){this.node.color=cc.Color.WHITE,this.fishnode&&this.fishnode.getComponent("fish").scalenormal()},findland:function(e){return null==e?null:Global.mainscene.lands[e].getComponent("land")},mergefish:function(e){var t=this;if(e.landid==this.landid)return this.attachFishNode(e.node),!1;if(this.fishshadownode)return this.fishnode.getComponent("fish").level==e.level&&(this.fishback(function(n,i){e.node.x=n,e.node.y=i,cc.tween(t.fishnode).to(.2,{position:cc.v2(60+n,i)}).to(.2,{position:cc.v2(n,i)}).start(),cc.tween(e.node).to(.2,{position:cc.v2(-60+n,i)}).to(.2,{position:cc.v2(n,i)}).call(function(){var n=e.level;t.findland(e.landid).fishnode=null,e.node.destroy(),t.fishnode.destroy();t.dropFish(n+1)}).start()}),!0);if(this.fishnode&&!this.fishshadownode){var n=this.fishnode.x,i=this.fishnode.y;return this.fishnode.getComponent("fish").level==e.level?(e.node.x=n,e.node.y=i,cc.tween(this.fishnode).to(.2,{position:cc.v2(60+n,i)}).to(.2,{position:cc.v2(n,i)}).start(),cc.tween(e.node).to(.2,{position:cc.v2(-60+n,i)}).to(.2,{position:cc.v2(n,i)}).call(function(){var n=e.level;t.findland(e.landid).fishnode=null,e.node.destroy(),t.fishnode.destroy();var i=cc.find("Canvas/gradeIcon"),c=t.node.getComponentInChildren("cc.ParticleSystem").node,o=c.convertToNodeSpaceAR(cc.mf.mainscene.node.convertToWorldSpaceAR(i));t.node.getComponentInChildren("cc.ParticleSystem").resetSystem(),cc.tween(c).to(1,{position:o}).call(function(){c.position=cc.v2(0,10)}).start();t.dropFish(n+1)}).start(),!0):(this.exchagefish(e),!1)}return this.findland(e.landid).fishnode=null,e.landid=this.landid,this.attachFishNode(e.node),!1},exchagefish:function(e){var t=this.fishnode,n=e.landid;this.attachFishNode(e.node),this.findland(n).attachFishNode(t)},fishup:function(){this.fishnode.getComponent("fish").receivetouch(!1);var e=new cc.Node;this.fishshadownode=e,e.parent=this.node.parent,e.addComponent(cc.Sprite),e.getComponent("cc.Sprite").sizeMode=cc.Sprite.SizeMode.CUSTOM;var t=this.fishnode;cc.loader.loadRes("fish/fish"+this.fish.level,cc.SpriteFrame,function(t,n){t?cc.log(t):e.getComponent("cc.Sprite").spriteFrame=n}),e.width=t.width,e.height=t.height,e.opacity=150,e.setPosition(this.node.getPosition().add(cc.v2(0,20)));e.on(cc.Node.EventType.TOUCH_START,function(e,t){this.fishback(function(){})},this)},fishback:function(e){var t=this;this.fishnode.getComponent("cc.CircleCollider").enabled=!1,this.fishnode.angle=this.fishnode.angle%360,cc.mf.fishActionManager.removeAllActionsFromTarget(this.fishnode),cc.tween(this.fishnode).to(.2,{position:cc.v2(this.node.getPosition().add(cc.v2(0,20))),angle:0}).call(function(){t.fishnode.getComponent("fish").receivetouch(!0),cc.loader.loadRes("fish/fish"+t.fishnode.getComponent("fish").level,cc.SpriteFrame,function(e,n){t.fishnode.getComponent("cc.Sprite").spriteFrame=n}),t.fishshadownode.destroy(),t.fishshadownode=null,e(t.fishnode.x,t.fishnode.y)}).start(),this.fish.running=!1,Global.mainscene.calcearn(),Global.mainscene.updatealllabel()},isfishrunning:function(){return!!this.fish&&this.fish.running}}),cc._RF.pop()},{}],levelupAlert:[function(e,t,n){"use strict";cc._RF.push(t,"24e0awnVIRIg6zfu2uj5K3k","levelupAlert"),cc.Class({extends:cc.Component,properties:{gradeLabel:cc.Label,coinsBounsLabel:cc.Label,diaBounsLabel:cc.Label,landBounsLabel:cc.Label},start:function(){},onEnable:function(){var e=cc.mf.FishCalc.currentlevel;this.gradeLabel.getComponent("cc.Label").string=e,this.coinsBounsLabel.getComponent("cc.Label").string=100*Math.pow(2,e-1),this.diaBounsLabel.getComponent("cc.Label").string=3,this.landBounsLabel.getComponent("cc.Label").string=1}}),cc._RF.pop()},{}],mainscene:[function(e,t,n){"use strict";var i;cc._RF.push(t,"b1b18kJzJ5JcbufbRIFp6m7","mainscene"),cc.Class({extends:cc.Component,initPlaces:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,t=cc.v2(-80,90),n=cc.v2(65,65),i=cc.v2(12,2),c=[],o=0;o<e;o++){var s=t.x+o%3*(n.x+i.x),a=t.y-Math.floor(o/3)*(n.y+i.y);c.push(cc.v2(s,a))}return c},ctor:function(){cc.mf={},cc.mf.mainscene=this,cc.mf.views={},Global.mainscene=this,cc.log("ctor: "+this.__classname__),this.landPlaces=this.initPlaces();var t=e("FishCalc");cc.mf.FishCalc=new t,i=cc.mf.FishCalc,cc.game.on(cc.game.EVENT_HIDE,function(){console.log("EVENT_HIDE\uff1a \u9000\u51fa\u6e38\u620f"),this.saveProgress()},this),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("EVENT_SHOW\uff1a show\u6e38\u620f"),this.calcofflinecoin()},this);var n=cc.director.getCollisionManager();n.enabled=!0,n.enabledDebugDraw=!1,cc.mf.sound={},cc.mf.sound.button=this.buttonsound},loadProgress:function(){if(cc.sys.localStorage.getItem("userData")){var e=JSON.parse(cc.sys.localStorage.getItem("userData"));i.trackcount=e.trackcount,i.currentdiamonds=e.currentdiamonds,i.currentexp=e.currentexp,i.currentlevel=e.currentlevel,i.doublespeedtime=e.doublespeedtime,i.fishtoplevel=e.fishtoplevel,i.currentcoins=e.currentcoins,i.boughtfishes=e.boughtfishes,i.audio_flag=e.audio_flag,i.music_flag=e.music_flag;for(var t=e.lands,n=0;n<t.length;n++)this.autoIncreaseLand();for(var c=0;c<t.length;c++){var o=t[c],s=this.lands[o.landid].getComponent("land");o.fishlevel>0&&(s.dropFish(o.fishlevel),o.fishrunning&&s.fish.runcircle())}this.onProgress(i.currentexp,i.currenttopexp)}else{cc.log("no userdata");for(var a=0;a<4;a++)this.autoIncreaseLand()}},saveProgress:function(){cc.sys.localStorage.setItem("quittime",Date.now()/1e3);for(var e={trackcount:i.trackcount,landcount:i.landcount,currentdiamonds:i.currentdiamonds,currentexp:i.currentexp,currentlevel:i.currentlevel,doublespeedtime:i.doublespeedtime,fishtoplevel:i.fishtoplevel,currentcoins:i.currentcoins,boughtfishes:i.boughtfishes,audio_flag:cc.mf.FishCalc.audio_flag,music_flag:cc.mf.FishCalc.music_flag},t=[],n=0;n<this.lands.length;n++){var c=this.lands[n].getComponent("land").fishnode;if(c){var o=c.getComponent("fish"),s={landid:n,fishlevel:o.level,fishrunning:o.running?1:0};t.push(s)}else{s={landid:n,fishlevel:-1,fishrunning:0};t.push(s)}}e.lands=t,cc.sys.localStorage.setItem("userData",JSON.stringify(e))},properties:{doublespeedtime:0,fishPrefab:{default:null,type:cc.Prefab},landPrefab:{default:null,type:cc.Prefab},fishbutton:cc.Button,lands:[],startpoint:cc.Node,endpoint:cc.Node,coinlabel:cc.Label,earnlabel:cc.Label,tracklabel:cc.Label,levellabel:cc.Label,diamondlabel:cc.Label,maskBg:cc.Sprite,exploadBar:cc.ProgressBar,sellfish:cc.Sprite,splashsound:{type:cc.AudioClip,default:null},coinsound:{type:cc.AudioClip,default:null},movesound:{type:cc.AudioClip,default:null},mergesound:{type:cc.AudioClip,default:null},newfishsound:{type:cc.AudioClip,default:null},levelupsound:{type:cc.AudioClip,default:null},buttonsound:{type:cc.AudioClip,default:null},addFishBtnound:{type:cc.AudioClip,default:null},speeduphBtnound:{type:cc.AudioClip,default:null},settingViewPrefab:{default:null,type:cc.Prefab},speedUpViewPrefab:{default:null,type:cc.Prefab},warnViewPrefab:{default:null,type:cc.Prefab},newFishAlertPrefab:{default:null,type:cc.Prefab},levelupAlertPrefab:{default:null,type:cc.Prefab},offlineBonusPrefab:{default:null,type:cc.Prefab},storeScrollViewPrefab:{default:null,type:cc.Prefab},sellgoods:"",landPlaces:{type:[cc.Vec2],get:function(){return this._landPlaces},set:function(e){this._landPlaces=e}}},onLoad:function(){var e=cc.Canvas.instance,t=e.designResolution.height/e.designResolution.width,n=cc.view.getFrameSize().height/cc.view.getFrameSize().width;console.log("winSize: rateR: "+t+" rateV: "+n),n>t?(e.fitHeight=!1,e.fitWidth=!0,console.log("winSize: fitWidth")):(e.fitHeight=!0,e.fitWidth=!1,console.log("winSize: fitHeight")),cc.log("onload: "+this.__classname__),cc.mf.fishActionManager||(cc.mf.fishActionManager=new cc.ActionManager),cc.mf.fishScheduler||(cc.mf.fishScheduler=new cc.Scheduler,cc.director.getScheduler().enableForTarget(cc.mf.fishScheduler),cc.director.getScheduler().scheduleUpdate(cc.mf.fishScheduler,cc.Scheduler.PRIORITY_NON_SYSTEM,!1),cc.mf.fishScheduler.scheduleUpdate(cc.mf.fishActionManager,cc.Scheduler.PRIORITY_NON_SYSTEM,!1)),this.loadProgress(),this.coinlabel.string=i.computeNumber(i.currentcoins),this.calcearn(),this.updatefishbutton(),this.updatealllabel(),this.node.on("NOTI_COINCHANGE",this.coinchange,this),this.node.on("NOTI_FISHCHANGE",this.fishchange,this),this.node.on("NOTI_LEVELCHANGE",this.levelchange,this),this.node.on("NOTI_EXPCHANGE",this.expchange,this),this.calcofflinecoin(),cc.mf.totalSpeedTime=3600,cc.mf.FishCalc.doublespeedtime>0&&(cc.mf.fishScheduler.setTimeScale(2),this.schedule(this.computeSpeedTime,1))},start:function(){var e=this.node.getChildByName("Main Camera").getChildByName("bgmusic").getComponent("cc.AudioSource");0==i.music_flag?e.pause():e.play()},updatealllabel:function(){this.tracklabel.string=this.runningfishcount()+"/"+i.trackcount,this.levellabel.string=i.currentlevel,this.diamondlabel.string=i.currentdiamonds,cc.find("Canvas/startpoint").getComponent("startpoint").updatetrack(this.runningfishcount(),i.trackcount)},updatefishbutton:function(){this.fishbutton.node.getComponentInChildren("cc.Label").string=i.computeNumber(i.defaultfishcost()),this.fishbutton.node.children.forEach(function(e){"fishIcon"!==e.name||cc.loader.loadRes("fish/fish"+i.defaultfishlevel(),cc.SpriteFrame,function(t,n){e.getComponent("cc.Sprite").spriteFrame=n})}),this.fishbutton.interactable=i.currentcoins>=i.defaultfishcost()},coinchange:function(e){this.coinlabel.string=i.computeNumber(i.currentcoins),this.updatefishbutton()},fishchange:function(e){this.updatefishbutton()},levelchange:function(e){e<=9&&(this.autoIncreaseLand(),i.trackcount+=1),e%3==0&&(i.currentdiamonds+=3),i.currentcoins+=100*Math.pow(2,e-1),this.showView(event,"levelupView",e),this.updatealllabel()},expchange:function(e){this.updatealllabel()},callback:function(e){"fishbutton"==e.target.name?this.autoIncreaseFish()&&(cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.addFishBtnound,!1,1),e.target.getComponentInChildren("cc.Label").string=i.computeNumber(i.defaultfishcost()),e.target.enabled=i.currentcoins>i.defaultfishcost()):this.autoIncreaseLand()},highlightfishlevel:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<this.lands.length;n++){var i=this.lands[n].getComponent("land").fishnode;i&&i.getComponent("fish").level==e&&(i.scale=t?1.2:1)}},autoIncreaseLand:function(){if(this.lands.length<this.landPlaces.length){var e=this.createLand(this.landPlaces[this.lands.length]);this.lands.push(e)}},autoIncreaseFish:function(){for(var e=0;e<this.lands.length;e++){var t=this.lands[e];if(!t.getComponent("land").fishnode)return i.currentcoins>i.defaultfishcost()?(i.buyfish(i.defaultfishlevel()),t.getComponent("land").dropFish(i.defaultfishlevel()),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.movesound,!1,1),this.onProgress(i.currentexp,i.currenttopexp)):(cc.mf.warnText="No enough money",this.showView(event,"warnView","No enough money")),!0}cc.mf.warnText="No empty lands. Buy more",this.showView(event,"warnView","No empty lands. Buy more")},hasEmptyLand:function(){return!0},createLand:function(e){var t=cc.instantiate(this.landPrefab);return this.node.addChild(t),t.setPosition(e),t.getComponent("land").landid=this.lands.length,t.getComponent("land").levelbg.node.active=!1,t},runningfishcount:function(){for(var e=0,t=0;t<this.lands.length;t++){this.lands[t].getComponent("land").isfishrunning()&&(e+=1)}return e},releasefish:function(e){for(var t=!1,n=e.node.getComponent("cc.CircleCollider").world.aabb,c=0;c<this.lands.length;c++){var o=this.lands[c],s=o.getComponent("cc.BoxCollider").world.aabb;if(cc.Intersection.rectRect(n,s)){o.getComponent("land").mergefish(e)?(this.fishmergedsuccess(e.level+1),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.mergesound,!1,1)):(e.returnback(),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.movesound,!1,1)),t=!0;break}}if(0==t)if(cc.Intersection.rectRect(n,this.startpoint.getComponent("cc.BoxCollider").world.aabb))i.trackcount>this.runningfishcount()?(e.runcircle(),this.calcearn(),this.updatealllabel(),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.splashsound,!1,1)):(cc.mf.warnText="No track availabel",this.showView(event,"warnView","No track availabel"),e.returnback(),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.movesound,!1,1));else if(this.sellfish&&cc.Intersection.rectRect(n,this.sellfish.getComponent("cc.BoxCollider").world.aabb)){cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.addFishBtnound,!1,1);var a=this.lands[e.landid];cc.mf.FishCalc.currentcoins+=cc.mf.FishCalc.fishsellcost(e.level),a.getComponent("land").fishnode.destroy(),a.getComponent("land").fishnode=null,this.refreshLandLevelLabel(),cc.tween(Global.mainscene.coinlabel.node).to(.2,{scale:1.2}).to(.2,{scale:1}).start();var l=cc.find("Canvas/sellFish/endpointcoin");l&&l.getComponent("cc.ParticleSystem").resetSystem(),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.coinsound,!1,1)}else e.returnback(),cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.movesound,!1,1)},calcearn:function(){for(var e=0,t=0;t<this.lands.length;t++){var n=this.lands[t].getComponent("land").fishnode;if(n){var c=n.getComponent("fish");c.running&&(e+=i.fishearn(c.level))}}return this.earnlabel.string="earn:"+i.computeNumber(e),e},fishmergedsuccess:function(e){var t=this;cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.newfishsound,!1,1),i.fishtoplevel<e&&(i.fishtoplevel=e,this.updatefishbutton(),setTimeout(function(){t.showView(event,"newFishAlert")},1))},calcofflinecoin:function(){var e=cc.sys.localStorage.getItem("quittime");if(e&&e>0){var t=Date.now()/1e3-e;if(t>5){var n=this.calcearn()*Math.min(t,3600);n>0&&(i.currentcoins+=n,this.showView(event,"offlineBonus"))}}},doubleBouns:function(e){cc.log(e.target.getComponentInChildren("cc.Label")),this.hideAlertView(),e.target.getComponentInChildren("cc.Label").string>i.currentdiamonds?(cc.mf.warnText="No enough diamond",this.showView(e,"warnView","No enough diamond")):cc.log("diamond calc")},refreshLandLevelLabel:function(){for(var e=0;e<this.lands.length;e++){var t=this.lands[e];t.getComponent("land").fishnode?t.getComponent("land").levelbg.node.active=!0:t.getComponent("land").levelbg.node.active=!1}},onProgress:function(e,t){var n=e/t;this.exploadBar.progress=0===n?0:n},fishdoublespeed:function(){cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(this.speeduphBtnound,!1,1),i.doublespeedtime>0?i.doublespeedtime+=150:i.doublespeedtime=150,cc.mf.views.speedUpView.getComponent("speedUpView").refreshTimeBar(),cc.mf.fishScheduler.setTimeScale(2),this.unschedule(this.computeSpeedTime),this.schedule(this.computeSpeedTime,1)},computeSpeedTime:function(){i.doublespeedtime--,i.doublespeedtime<=0&&(this.unschedule(this.computeSpeedTime),cc.mf.fishScheduler.setTimeScale(1))},showView:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(Global.mainscene.addFishBtnound,!1,1),this.maskBg.node.active=!0,cc.mf.views[t]);else{switch(t){case"warnView":cc.mf.views[t]=cc.instantiate(this.warnViewPrefab);break;case"storeScrollView":cc.mf.views[t]=cc.instantiate(this.storeScrollViewPrefab);break;case"newFishAlert":cc.mf.views[t]=cc.instantiate(this.newFishAlertPrefab);break;case"offlineBonus":cc.mf.views[t]=cc.instantiate(this.offlineBonusPrefab);break;case"speedUpView":cc.mf.views[t]=cc.instantiate(this.speedUpViewPrefab);break;case"levelupView":cc.mf.views[t]=cc.instantiate(this.levelupAlertPrefab);break;case"settingView":cc.mf.views[t]=cc.instantiate(this.settingViewPrefab)}cc.mf.views[t].setPosition(cc.v2(0,0)),this.node.parent.addChild(cc.mf.views[t])}cc.mf.views[t].active=!0,cc.tween(cc.mf.views[t]).to(.2,{scale:1.05}).to(.2,{scale:1}).start()}}),cc._RF.pop()},{FishCalc:"FishCalc"}],newFishAlert:[function(e,t,n){"use strict";var i;function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"e51c0mENd5HAZycxegqohgI","newFishAlert"),cc.Class((c(i={extends:cc.Component,properties:{paperParticle:cc.ParticleSystem,newFish:cc.Node,leftFish:cc.Node,rightFish:cc.Node,gloss:cc.Node,button:cc.Node,speedProgress:cc.Node,earnCoinsProgress:cc.Node},ctor:function(){},onEnable:function(){this.paperParticle&&this.paperParticle.resetSystem()},start:function(){cc.mf.leftfish=this.leftFish,cc.mf.newfish=this.newFish,cc.mf.gloss=this.gloss,this.gloss.scale=0,this.newFish.scale=0,this.button.scale=0,this.speedProgress.scale=0,this.earnCoinsProgress.scale=0}},"onEnable",function(){var e=this;cc.loader.loadRes("fish/fish"+cc.mf.FishCalc.fishtoplevel,cc.SpriteFrame,function(t,n){t?cc.log(t):e.newFish.getComponent("cc.Sprite").spriteFrame=n}),cc.loader.loadRes("fish/fish"+Math.max(1,cc.mf.FishCalc.fishtoplevel-1),cc.SpriteFrame,function(t,n){t?cc.log(t):(e.leftFish.getComponent("cc.Sprite").spriteFrame=n,e.rightFish.getComponent("cc.Sprite").spriteFrame=n)}),this.leftfishaction()}),c(i,"leftfishaction",function(){var e=this;setTimeout(function(){e.gloss.getComponent("cc.ParticleSystem").resetSystem()},1e3),cc.tween(this.leftFish).repeat(5,cc.tween().to(.1,{angle:-3}).to(.1,{angle:3})).then(cc.tween().to(.4,{position:this.newFish.position,opacity:0},{easing:"backIn"})).start(),cc.tween(this.rightFish).repeat(5,cc.tween().to(.1,{angle:-3}).to(.1,{angle:3})).then(cc.tween().to(.4,{position:this.newFish.position,opacity:0},{easing:"backIn"})).call(function(){cc.tween(e.newFish).to(.5,{scale:1,opacity:255},{easing:"backInOut"}).start(),e.newFish.getComponentInChildren("cc.ParticleSystem").resetSystem(),cc.tween(e.button).delay(.8).to(.2,{scale:1},{easing:"sineInOut"}).start(),e.speedProgress.getChildByName("speedprogress").width=135.5*cc.mf.FishCalc.fishtoplevel/27,e.earnCoinsProgress.getChildByName("coinsprogress").width=135.5*cc.mf.FishCalc.fishtoplevel/27,cc.tween(e.speedProgress).delay(.8).to(.2,{scale:1},{easing:"sineInOut"}).start(),cc.tween(e.earnCoinsProgress).delay(.8).to(.2,{scale:1},{easing:"sineInOut"}).start()}).start()}),c(i,"onDisable",function(){this.node.destroy(),cc.mf.views.newFishAlert=null}),i)),cc._RF.pop()},{}],offlineBouns:[function(e,t,n){"use strict";cc._RF.push(t,"6dbe1nGnwtCqZCkauof5mAS","offlineBouns"),cc.Class({extends:cc.Component,properties:{bounsCount:cc.Label},start:function(){this.bounsCount.node.getComponent("cc.Label").string="+"+cc.mf.FishCalc.computeNumber(cc.mf.FishCalc.currentcoins)},diamondDoubleCoins:function(){cc.log("diamondDoubleCoins")}}),cc._RF.pop()},{}],settingView:[function(e,t,n){"use strict";cc._RF.push(t,"c2793pDqyxGIrt9+Ic3R6DR","settingView"),cc.Class({extends:cc.Component,properties:{bgMusic:cc.Sprite,audio:cc.Sprite,musicBtnBg:cc.Sprite,audioBtnBg:cc.Sprite},start:function(){this.loadImage(this.audioBtnBg.node,this.audio.node,cc.mf.FishCalc.audio_flag,!1),this.loadImage(this.musicBtnBg.node,this.bgMusic.node,cc.mf.FishCalc.music_flag,!1)},bgMusiSwitch:function(){cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(Global.mainscene.addFishBtnound,!1,1);var e=cc.find("Canvas/Main Camera/bgmusic").getComponent("cc.AudioSource");cc.mf.FishCalc.music_flag?e.pause():e.play(),cc.mf.FishCalc.music_flag=!cc.mf.FishCalc.music_flag,this.loadImage(this.musicBtnBg.node,this.bgMusic.node,cc.mf.FishCalc.music_flag,!0)},audioSwitch:function(){cc.mf.FishCalc.audio_flag&&cc.audioEngine.play(Global.mainscene.addFishBtnound,!1,1),cc.mf.FishCalc.audio_flag=!cc.mf.FishCalc.audio_flag,this.loadImage(this.audioBtnBg.node,this.audio.node,cc.mf.FishCalc.audio_flag,!0)},loadImage:function(e,t,n,i){var c,o;c=n?24:-24,i?cc.tween(t).to(.2,{position:cc.v2(c,0)}).start():t.x=c,o=n?"ui/music_bg2":"ui/music_bg",cc.loader.loadRes(o,cc.SpriteFrame,function(t,n){t?cc.log(t):e.getComponent("cc.Sprite").spriteFrame=n})}}),cc._RF.pop()},{}],speedUpView:[function(e,t,n){"use strict";cc._RF.push(t,"c3aa1g/OvxOgqHLIm3qtQqb","speedUpView"),cc.Class({extends:cc.Component,properties:{timeBarProgress:cc.Sprite,timeLabel:cc.Label},refreshTimeBar:function(){cc.mf.FishCalc.doublespeedtime>0?(this.timeBarProgress.node.width=201.07*cc.mf.FishCalc.doublespeedtime/cc.mf.totalSpeedTime,cc.tween(this.timeBarProgress.node).to(cc.mf.FishCalc.doublespeedtime,{width:0}).start(),this.schedule(this.speedTimerStart,1)):this.timeBarProgress.node.width=0},doublespeedBtn:function(){Global.mainscene.fishdoublespeed()},onEnable:function(){cc.log(this.timeLabel.node.getComponent("cc.Label").string),cc.log(cc.mf.FishCalc.doublespeedtime),this.speedTimer(),this.refreshTimeBar()},onDisable:function(){this.unschedule(this.speedTimerStart)},speedTimer:function(){var e,t,n,i=cc.mf.FishCalc.doublespeedtime;return i>=3600?(e=Math.floor(i/3600)>=10?Math.floor(i/3600):"0"+Math.floor(i/3600),t=Math.floor(i%3600/60)>=10?Math.floor(i%3600/60):"0"+Math.floor(i%3600/60),n=i%3600%60>=10?i%3600%60:"0"+i%3600%60):i<3600&&i>60?(e="00",t=Math.floor(i/60)>=10?Math.floor(i/60):"0"+Math.floor(i/60),n=i%60>=10?i%60:"0"+i%60):(e="00",t="00",n=i>=10?i:"0"+i),cc.log(e+":"+t+":"+n),e+":"+t+":"+n},speedTimerStart:function(){this.timeLabel.node.getComponent("cc.Label").string=this.speedTimer(),cc.mf.FishCalc.doublespeedtime<=0&&this.unschedule(this.speedTimerStart)}}),cc._RF.pop()},{}],startpoint:[function(e,t,n){"use strict";cc._RF.push(t,"a115a0YLAJGQrC8BncJusZJ","startpoint"),cc.Class({extends:cc.Component,properties:{unselectSpriteFrame:cc.SpriteFrame,selectedSpriteFrame:cc.SpriteFrame},ctor:function(){var e=this;cc.loader.loadRes("ui/arrow2",cc.SpriteFrame,function(t,n){t?cc.log(t):e.unselectSpriteFrame=n}),cc.loader.loadRes("ui/arrow1",cc.SpriteFrame,function(t,n){t?cc.log(t):e.selectedSpriteFrame=n})},onLoad:function(){},start:function(){},updatetrack:function(e,t){var n=this,i=this.node.children.length;if(cc.log("should set:"+e+"/"+t+"  current total:"+i),t>i)for(var c=function(e){(s=new cc.Node).name="arrow"+e,s.addComponent(cc.Sprite),s.getComponent("cc.Sprite").sizeMode=cc.Sprite.SizeMode.CUSTOM,s.width=36,s.height=32,n.unselectSpriteFrame?s.getComponent("cc.Sprite").spriteFrame=n.unselectSpriteFrame:cc.loader.loadRes("ui/arrow2",cc.SpriteFrame,function(t,i){t?cc.log(t):(n.unselectSpriteFrame=i,n.node.children[e].getComponent("cc.Sprite").spriteFrame=n.unselectSpriteFrame,cc.log("async arrow:"+n.node.children[e].name))}),cc.log("add arrow:"+s.name),n.node.addChild(s)},o=0;o<t-i;o++){var s;c(o)}for(o=0;o<this.node.children.length;o++){var a=this.node.children[o];a.getComponent("cc.Sprite").spriteFrame=o<e?this.selectedSpriteFrame:this.unselectSpriteFrame}this.node.getComponent("cc.Layout").updateLayout()}}),cc._RF.pop()},{}],start:[function(e,t,n){"use strict";cc._RF.push(t,"dd561wiHuFNZ7KjRxvIGjqp","start");var i=null;cc.Class({extends:cc.Component,properties:{loadBar:cc.ProgressBar,loadfish:cc.Sprite,_progress:0},onLoad:function(){(i=this).loadBar.fillRange=0,cc.loader.loadResDir("fish",cc.SpriteFrame,this.onProgress,this.onLoadComplete)},onProgress:function(e,t,n){var c=e/t;i._progress=c,i.loadBar.progress=c},onLoadComplete:function(e,t){cc.log("load res:"+t.length),cc.director.preloadScene("MainScene",function(){cc.log("Mainscene preloaded"),cc.director.loadScene("MainScene")})},start:function(){},update:function(e){}}),cc._RF.pop()},{}],storeScrollView:[function(e,t,n){"use strict";cc._RF.push(t,"d8647/gz/tPgKGFP8+AuVql","storeScrollView"),cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,maskBg:cc.Sprite},onLoad:function(){},start:function(){},createContentItem:function(){for(var e=this,t=this.node.getChildByName("view").getChildByName("content"),n=cc.mf.FishCalc.fishtoplevel,i=function(i){(o=cc.instantiate(e.itemPrefab)).children.forEach(function(t){"fishgreen"===t.name?(t.getComponentInChildren("cc.Sprite").node.getComponentInChildren("cc.Label").string=i,i>n&&(t.getComponent("cc.Sprite").node.color=new cc.Color(10,10,10)),cc.loader.loadRes("fish/fish"+i,cc.SpriteFrame,function(e,n){e?cc.log(e):t.getComponent("cc.Sprite").spriteFrame=n})):"runcoins"===t.name?t.getComponent("cc.Label").string=cc.mf.FishCalc.computeNumber(cc.mf.FishCalc.fishearn(i))+"/S":"coins_btn"===t.name?i>n-4&&i>1?(t.getComponentInChildren("cc.Label").string="Lock",cc.loader.loadRes("ui/btn_gray@2x",cc.SpriteFrame,function(e,n){e?cc.log(e):t.getComponentInChildren("cc.Sprite").spriteFrame=n}),t.getChildByName("Background").getChildByName("coinsIcon").active=!1):(t.getComponentInChildren("cc.Label").string=cc.mf.FishCalc.computeNumber(cc.mf.FishCalc.fishcost(i)),t.on(cc.Node.EventType.TOUCH_START,function(e,t){this.payforfish(e)},e)):"lockIcon"===t.name?t.active=i>n:"btn_coins"===t.name&&i>n&&cc.loader.loadRes("ui/coins_gray@2x",cc.SpriteFrame,function(e,n){e?cc.log(e):t.getComponent("cc.Sprite").spriteFrame=n})}),t.addChild(o)},c=1;c<28;c++){var o;i(c)}},payforfish:function(e){for(var t=e.currentTarget.getComponentInChildren("cc.Label").node,n=parseInt(e.currentTarget.parent.getChildByName("fishgreen").getComponentInChildren("cc.Sprite").node.getComponentInChildren("cc.Label").string),i=Global.mainscene.lands,c=0;c<i.length;c++){var o=i[c];if(!o.getComponent("land").fishnode){cc.mf.FishCalc.currentcoins>cc.mf.FishCalc.fishcost(n)?(cc.mf.FishCalc.buyfish(n),t.getComponent("cc.Label").string=cc.mf.FishCalc.computeNumber(cc.mf.FishCalc.fishcost(n)),o.getComponent("land").dropFish(n)):(cc.mf.warnText="No enough money",Global.mainscene.showView(event,"warnView","No enough money"));break}}Global.mainscene.updatefishbutton()},onDisable:function(){for(var e=this.node.getChildByName("view").getChildByName("content").children,t=0;t<e.length;t++)e[t].destroy()},onEnable:function(){this.createContentItem()}}),cc._RF.pop()},{}],warnView:[function(e,t,n){"use strict";cc._RF.push(t,"b81649tCahGhbkQlh73YMu8","warnView"),cc.Class({extends:cc.Component,properties:{},start:function(){},onEnable:function(){var e=this;this.node.getComponentInChildren("cc.Label").string=cc.mf.warnText,setTimeout(function(){e.node.active=!1,cc.mf.mainscene.maskBg.node.active=!1},1500)}}),cc._RF.pop()},{}]},{},["BaseView","FishCalc","drawtest","endpoint","fish","global","land","levelupAlert","mainscene","newFishAlert","offlineBouns","settingView","speedUpView","start","startpoint","storeScrollView","warnView"]);